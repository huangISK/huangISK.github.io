<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="什么是Spring MVC简介 &amp;emsp;&amp;emsp; 【官网】Spring Web MVC is the original web framework built on the Servlet API and has been included in the Spring Framework from the very beginning. The formal name, &quot;Spring W">
<meta property="og:type" content="article">
<meta property="og:title" content="SpringMVC">
<meta property="og:url" content="http://example.com/2023/03/17/SpringMVC/index.html">
<meta property="og:site_name" content="Human Instrumentality Project">
<meta property="og:description" content="什么是Spring MVC简介 &amp;emsp;&amp;emsp; 【官网】Spring Web MVC is the original web framework built on the Servlet API and has been included in the Spring Framework from the very beginning. The formal name, &quot;Spring W">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2023/03/17/SpringMVC//images/pic.png">
<meta property="og:image" content="http://example.com/2023/03/17/SpringMVC//images/pic1.png">
<meta property="og:image" content="http://example.com/2023/03/17/SpringMVC//images/pc2.png">
<meta property="og:image" content="http://example.com/2023/03/17/SpringMVC//images/pic6.png">
<meta property="article:published_time" content="2023-03-17T00:52:52.000Z">
<meta property="article:modified_time" content="2023-03-17T12:59:43.778Z">
<meta property="article:author" content="Alexior">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2023/03/17/SpringMVC//images/pic.png">

<link rel="canonical" href="http://example.com/2023/03/17/SpringMVC/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>SpringMVC | Human Instrumentality Project</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Human Instrumentality Project</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/17/SpringMVC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Alexior">
      <meta itemprop="description" content="蓦然回首，那是我们逝去的青春">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Human Instrumentality Project">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          SpringMVC
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2023-03-17 08:52:52 / 修改时间：20:59:43" itemprop="dateCreated datePublished" datetime="2023-03-17T08:52:52+08:00">2023-03-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="什么是Spring-MVC"><a href="#什么是Spring-MVC" class="headerlink" title="什么是Spring MVC"></a>什么是Spring MVC</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>
&emsp;&emsp;
【官网】Spring Web MVC is the original web framework built on the Servlet API and has been included in the Spring Framework from the very beginning. The formal name, "Spring Web MVC," comes from the name of its source module (spring-webmvc), but it is more commonly known as "Spring MVC".<br>
&emsp;&emsp;
【翻译】Spring Web MVC是基于 Servlet API 构建的轻量级原始 Web 框架，从一开始就包含在 Spring 框架中。正式名称 Spring Web MVC 来自其源模块（spring-webmvc）的名称，但更常见的名称是 Spring MVC。<br>
&emsp;&emsp;
Spring MVC 通过把<strong>模型-视图-控制器</strong>分离，将web层进行职责解耦，方便开发。
</p>

<h2 id="请求执行流程"><a href="#请求执行流程" class="headerlink" title="请求执行流程"></a>请求执行流程</h2><img src="\images\pic.png" width= 700 height=512 />
【注意】springmvc是单例模式，所以在多线程访问的时候有线程安全问题，不要用同步，会影响性能的，解决方案是在控制器里面不能写字段。

<h1 id="DispatcherServlet"><a href="#DispatcherServlet" class="headerlink" title="DispatcherServlet"></a>DispatcherServlet</h1><img src="\images\pic1.png" width= 800 height=512 />

<p>DispatcherServlet入口：</p>
<ul>
<li>init()：<br>加载web.xml中DispatcherServlet配置，调用initServletBean()（继承父类）。</li>
<li>initServletBean()：<br>调用initWebApplicationContext()（继承父类）。</li>
<li>initWebApplicationContext()：<br>初始化IOC容器，调用createWebApplicationContext方法（继承父类）。</li>
<li>createWebApplicationContext(WebApplicationContext)：<br>获取或生成容器，调用onRefresh方法。</li>
<li>onRefresh(ApplicationContext)：<br>用于在ApplicationContext刷新后进行策略组件的初始化。</li>
<li><strong>initStrategies(ApplicationContext)</strong> ：<br>初始化9个策略组件。</li>
<li>doService()：<br>设置request的相关属性。</li>
<li>doDispatch()：<br>DispatcherServlet获取HandlerMapping和HandlerAdapter。</li>
<li>processDispatchResult(processedRequest, response, mappedHandler, mv,dispatchException)<br>异常分析，存在ModelAndView后调用render方法进行渲染，渲染完成后调用HandlerInterceptor拦截器的afterCompletion方法。</li>
<li>render():<br>解析视图名称获取对应View，调用View的render方法通过Model来渲染视图。</li>
</ul>
<h1 id="SpringMVC的九大组件"><a href="#SpringMVC的九大组件" class="headerlink" title="SpringMVC的九大组件"></a>SpringMVC的九大组件</h1><ol>
<li>HandlerMapping<br>根据request找到相应的处理器。因为Handler（Controller）有两种形式，一种是基于类的Handler，另一种是基于Method的Handler（也就是我们常用的）。</li>
<li>HandlerAdapter<br>调用Handler的适配器。如果把Handler（Controller）当做工具的话，那么HandlerAdapter就相当于干活的工人。</li>
<li>HandlerExceptionResolver<br>对异常的处理。</li>
<li>ViewResolver<br>用来将String类型的视图名和Locale解析为View类型的视图。</li>
<li>RequestToViewNameTranslator<br>有的Handler（Controller）处理完后没有设置返回类型，比如是void方法，这是就需要从request中获取viewName。</li>
<li>LocaleResolver<br>从request中解析出Locale。Locale表示一个区域，比如zh-cn，对不同的区域的用户，显示不同的结果，这就是i18n（SpringMVC中有具体的拦截器LocaleChangeInterceptor）。</li>
<li>ThemeResolver<br>主题解析，这种类似于我们手机更换主题，不同的UI，css等。</li>
<li>MultipartResolver<br>处理上传请求，将普通的request封装成MultipartHttpServletRequest。</li>
<li>FlashMapManager<br>用于管理FlashMap，FlashMap用于在redirect重定向中传递参数。</li>
</ol>
<h1 id="HandlerMapping"><a href="#HandlerMapping" class="headerlink" title="HandlerMapping"></a>HandlerMapping</h1><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>
&emsp;&emsp;
HandlerMapping 功能就是根据请求匹配到对应的 Handler，然后将找到的 Handler 和所有匹配的 HandlerInterceptor（拦截器）绑定到创建的 HandlerExecutionChain 对象上并返回。<br>
&emsp;&emsp;
HandlerMapping 只是一个接口类，不同的实现类有不同的匹对方式，根据功能的不同我们需要在 SpringMVC 容器中注入不同的映射处理器 HandlerMapping。<br>
&emsp;&emsp;
我们常见的No mapping found for HTTP request with URI……错误也是因为HandlerMapping没有找到对应handler。
</p>

<h2 id="dispatchServlet的初始化"><a href="#dispatchServlet的初始化" class="headerlink" title="dispatchServlet的初始化"></a>dispatchServlet的初始化</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">private void initHandlerMappings(ApplicationContext context) &#123;</span><br><span class="line">	容器被初始化的时候会被调用，加载容器中注入的 HandlerMapping。</span><br><span class="line">   其实常用到的 HandlerMapping 都是由 &lt;mvc:annotation-driven /&gt; 标签帮我们注册的(包括 RequestMappingHandlerMapping 和 BeanNameUrlHandlerMapping)，</span><br><span class="line">   如果没有写该标签系统也会帮我们注入默认的映射器，当然也有些需要我们自己手动注入。</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>
&emsp;&emsp;
HandlerMapping 接口中只有一个方法getHandler。DispatcherServlet在处理请求得时候，会调用AbstractHandlerMapping的getHandler()方法将通用拦截器以及根据Url匹配得拦截器放入集合中，最后将handle处理器和拦截器集合封装成HandlerExecutionChain对象返回：
</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@Override </span><br><span class="line">@Nullable </span><br><span class="line">public final HandlerExecutionChain getHandler(HttpServletRequest request) throws Exception&#123;</span><br><span class="line">  // &lt;1&gt; 获得处理器（HandlerMethod 或者 HandlerExecutionChain），该方法是抽象方法，由子类实现 </span><br><span class="line">  Object handler = getHandlerInternal(request); </span><br><span class="line">  // &lt;2&gt; 获得不到，则使用默认处理器 </span><br><span class="line">  // &lt;3&gt; 还是获得不到，则返回 null </span><br><span class="line">  // &lt;4&gt; 如果找到的处理器是 String 类型，则从 Spring 容器中找到对应的 Bean 作为处理器 </span><br><span class="line">  // &lt;5&gt; 创建 HandlerExecutionChain 对象（包含处理器和拦截器） </span><br><span class="line">  // ... </span><br><span class="line"><span class="built_in">return</span> executionChain;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
【注】getHandlerInternal(HttpServletRequest request) 抽象方法，获取请求对应的处理器，该方法由子类去实现。
## HandlerMapping接口
<img src="\images\pc2.png" width= 852 height=512 />

<h3 id="BeanNameUrlHandlerMapping"><a href="#BeanNameUrlHandlerMapping" class="headerlink" title="BeanNameUrlHandlerMapping"></a>BeanNameUrlHandlerMapping</h3><p>该实现类可以把容器中name以”&#x2F;“ 开头的Bean注册为handler。在xml文件中注册：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean name=<span class="string">&quot;/hello.html&quot;</span> class=<span class="string">&quot;com.xxx.controller.HelloController&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>
<h3 id="SimpleUrlHandlerMapping"><a href="#SimpleUrlHandlerMapping" class="headerlink" title="SimpleUrlHandlerMapping"></a>SimpleUrlHandlerMapping</h3><p>在xml文件中注册：<br><strong>prop key方式</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;beans ...&gt; </span><br><span class="line">    &lt;bean class=<span class="string">&quot;org.springframework.web.servlet.handler.SimpleUrlHandlerMapping&quot;</span>&gt;</span><br><span class="line">       &lt;property name=<span class="string">&quot;mappings&quot;</span>&gt;</span><br><span class="line">        &lt;props&gt;</span><br><span class="line">           &lt;prop key=<span class="string">&quot;/welcome.htm&quot;</span>&gt;welcomeController&lt;/prop&gt;</span><br><span class="line">           &lt;prop key=<span class="string">&quot;/*/welcome.htm&quot;</span>&gt;welcomeController&lt;/prop&gt;</span><br><span class="line">           &lt;prop key=<span class="string">&quot;/helloGuest.htm&quot;</span>&gt;helloGuestController&lt;/prop&gt;</span><br><span class="line">         &lt;/props&gt;</span><br><span class="line">       &lt;/property&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;bean <span class="built_in">id</span>=<span class="string">&quot;welcomeController&quot;</span> </span><br><span class="line">        class=<span class="string">&quot;com.mkyong.common.controller.WController&quot;</span> /&gt;        </span><br><span class="line">    &lt;bean <span class="built_in">id</span>=<span class="string">&quot;helloGuestController&quot;</span> </span><br><span class="line">        class=<span class="string">&quot;com.mkyong.common.controller.HController&quot;</span> /&gt;     </span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<p><strong>value方式</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;beans ...&gt; </span><br><span class="line">    &lt;bean class=<span class="string">&quot;org.springframework.web.servlet.handler.SimpleUrlHandlerMapping&quot;</span>&gt;</span><br><span class="line">       &lt;property name=<span class="string">&quot;mappings&quot;</span>&gt;</span><br><span class="line">        &lt;value&gt;</span><br><span class="line">           /welcome.htm=welcomeController</span><br><span class="line">           /*/welcome.htm=welcomeController</span><br><span class="line">           /helloGuest.htm=helloGuestController</span><br><span class="line">        &lt;/value&gt;</span><br><span class="line">       &lt;/property&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;bean <span class="built_in">id</span>=<span class="string">&quot;welcomeController&quot;</span> </span><br><span class="line">        class=<span class="string">&quot;com.mkyong.common.controller.WController&quot;</span> /&gt;        </span><br><span class="line">    &lt;bean <span class="built_in">id</span>=<span class="string">&quot;helloGuestController&quot;</span> </span><br><span class="line">        class=<span class="string">&quot;com.mkyong.common.controller.HController&quot;</span> /&gt;           </span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<p><strong>map填入entry键值对</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;beans ...&gt; </span><br><span class="line">...</span><br><span class="line">&lt;property name=<span class="string">&quot;mappings&quot;</span>&gt;</span><br><span class="line">    &lt;map&gt;</span><br><span class="line">        &lt;entry key=<span class="string">&quot;/welcome&quot;</span> value=<span class="string">&quot;welcomeController&quot;</span> /&gt;</span><br><span class="line">        &lt;entry key=<span class="string">&quot;/hello&quot;</span> value=<span class="string">&quot;helloGuestController&quot;</span> /&gt;</span><br><span class="line">        &lt;entry key=<span class="string">&quot;/hi&quot;</span> value=<span class="string">&quot;helloLuBanController&quot;</span> /&gt;</span><br><span class="line">        &lt;entry key=<span class="string">&quot;/login&quot;</span> value=<span class="string">&quot;loginHttpServlet&quot;</span> /&gt;</span><br><span class="line">    &lt;/map&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">    ...</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<p><strong>properties 配置文件</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;beans ...&gt; </span><br><span class="line">...</span><br><span class="line">&lt;property name=<span class="string">&quot;mappings&quot;</span>&gt;</span><br><span class="line">	&lt;bean class=<span class="string">&quot;org.springframework.beans.factory.config.PropertiesFactoryBean&quot;</span>&gt;</span><br><span class="line">		&lt;property name=<span class="string">&quot;location&quot;</span> value=<span class="string">&quot;classpath:spring/url-mapping.properties&quot;</span>/&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line"> ...</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<p>url-mapping.properties:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/welcome = welcomeController</span><br><span class="line">/hello = helloGuestController</span><br><span class="line">/hi = helloLuBanController</span><br><span class="line">/login = loginHttpServlet</span><br></pre></td></tr></table></figure>

<h3 id="RequestMappingHandlerMapping"><a href="#RequestMappingHandlerMapping" class="headerlink" title="RequestMappingHandlerMapping"></a>RequestMappingHandlerMapping</h3><p>
&emsp;&emsp;
顾名思义就是针对@RequestMapping注解。如果想要 RequestMapping 注解生效，必须在 xml 文件中配置< mvc:annotation-driven/>。
</p>

<p>【扩展】RequestMapping注解</p>
<ul>
<li>value属性<br>@RequestMapping(value &#x3D;”&#x2F;example”)：一对一<br>@RequestMapping(value &#x3D; {“&#x2F;page1”,”&#x2F;page2”,”&#x2F;page3”})：多对一</li>
<li>name<br>注释，使方法更易理解.</li>
<li>method 属性<br>用于表示该方法支持哪些 HTTP 请求，例如:<br>@RequestMapping(method &#x3D; RequestMethod.GET)<br>@RequestMapping(method &#x3D; {RequestMethod.GET, RequestMethod.DELETE})<br>请求方式不符合会报错.</li>
<li>params 属性（了解）<br> 要求所匹配的请求是否必须携带 param 参数，并且可以指定携带参数的值.</li>
<li>consumers 属性（了解）<br>用于指定处理请求的提交内容类型（Content-Type），例如：application&#x2F;json、text&#x2F;html.</li>
<li>header 属性（了解）<br>要求所匹配的请求是否必须携带请求头信息，并且可以指定请求头信息的值.</li>
</ul>
<h1 id="HandlerAdapter"><a href="#HandlerAdapter" class="headerlink" title="HandlerAdapter"></a>HandlerAdapter</h1><h2 id="简介-1"><a href="#简介-1" class="headerlink" title="简介"></a>简介</h2><p>
&emsp;&emsp;
根据 Handler 来找到支持它的 HandlerAdapter，通过 HandlerAdapter 执行这个 Handler 得到 ModelAndView 对象。dispatcherServlet就是通过这个接口来访问handler的，而不是直接去访问真正的实际的处理器，这样做的好处是：处理器程序允许是任意的Object；集成第三方请求处理器的时候，本处代码也无需修改。此接口不适用于应用程序开发人员。
</p>

<h2 id="为何需要使用HandlerAdapter适配"><a href="#为何需要使用HandlerAdapter适配" class="headerlink" title="为何需要使用HandlerAdapter适配"></a>为何需要使用HandlerAdapter适配</h2><p>
&emsp;&emsp;
Spring MVC的Handler（Controller接口，HttpRequestHandler，Servlet、@RequestMapping）有四种表现形式，在Handler不确定是什么方式的时候（可能是方法、也可能是类），适配器这种设计模式就能模糊掉具体的实现，从而就能提供统一访问接口。<br>
&emsp;&emsp;
处理器Handler需要程序员去写代码处理逻辑的，而处理器适配器（HandlerAdapter）会把处理器包装成适配器，这样就可以支持多种类型的处理器。
</p>

<h2 id="与HandlerMapping区别"><a href="#与HandlerMapping区别" class="headerlink" title="与HandlerMapping区别"></a>与HandlerMapping区别</h2><p>
（1）HandlerMapping的作用主要是根据request请求匹配/映射上能够处理当前request的handler。<br>
（2）HandlerAdapter的作用在于将request中的各个属性，如request param适配为handler能够处理的形式，参数绑定、数据校验、内容协商…几乎所有的web层问题都在在这里完成的。
</p>

<h2 id="实现类"><a href="#实现类" class="headerlink" title="实现类"></a>实现类</h2><img src="\images\pic6.png" width= 800 height=150 />
<p>
&emsp;&emsp;
重点是 RequestMappingHandlerAdapter，作为适配 @RequestMapping 注解标注的 Handler，它是自 Spring3.1 新增的一个适配器类，拥有数据绑定、数据转换、数据校验、内容协商…等一系列非常高级的功能。
</p>

<h1 id="SpringMVC中请求参数的接收"><a href="#SpringMVC中请求参数的接收" class="headerlink" title="SpringMVC中请求参数的接收"></a>SpringMVC中请求参数的接收</h1><h2 id="简介-2"><a href="#简介-2" class="headerlink" title="简介"></a>简介</h2><p>
&emsp;&emsp;
对于 HttpServletRequest 和 HttpServletResponse，我们可以调用 getInputStream 和 getOutputStream 来直接获取请求信息，不过返回值只是一段字符串，对于开发人员来说，处理一个对象肯定比处理一个字符串要方便得多，也好理解得多，所以对数据的封装转换是不可避免的事。<br>
&emsp;&emsp;
SpringMVC通过反射的方式调用Controller的方法，然后将请求的参数解析，并和方法的形参做匹配并传递过去。一般的表单或者JSON数据的请求都是相对简单的，一些复杂的处理主要包括日期、URL路径参数、文件上传、数组或者列表类型数据等。<br>
&emsp;&emsp;
SpringMVC 中处理控制器参数的接口是 HandlerMethodArgumentResolver ，此接口有众多子类，分别处理不同（注解类型）的参数。
</p>

<h2 id="HandlerMethodArgumentResolver"><a href="#HandlerMethodArgumentResolver" class="headerlink" title="HandlerMethodArgumentResolver"></a>HandlerMethodArgumentResolver</h2><h3 id="介绍-1"><a href="#介绍-1" class="headerlink" title="介绍"></a>介绍</h3><p>
&emsp;&emsp;
接口：用于在给定请求的上下文中将方法参数解析为参数值。简单的理解为：它负责处理你Handler方法里的所有入参：包括自动封装、自动赋值、校验等等。Spring MVC 内置了非常多的实现类，当然你还可以自定义和注册。<br>
&emsp;&emsp;
有个形象的公式：HandlerMethodArgumentResolver = HandlerMethod + Argument(参数) + Resolver(解析器)
</p>

<h3 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface HandlerMethodArgumentResolver &#123;</span><br><span class="line">    boolean	supportsParameter(MethodParameter parameter);</span><br><span class="line">    Object 	resolveArgument(MethodParameter parameter, ...) throws Exception;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>supportsParameter（支持参数）：可以设置一些标志，表示你这个分解器可以处理这些参数，返回ture才执行resolveArgument()函数</li>
<li>resolveArgument：真正用于处理参数分解的方法，返回的Object就是controller方法上的形参对象。</li>
</ul>
<p>PS：ArgumentResolver在初始化时有一个默认的顺序，如果多个ArgumentResolver可以解析某一种类型，以顺序在前面的先解析。</p>
<h3 id="常见的-HandlerMethodArgumentResolver实现类"><a href="#常见的-HandlerMethodArgumentResolver实现类" class="headerlink" title="常见的 HandlerMethodArgumentResolver实现类"></a>常见的 HandlerMethodArgumentResolver实现类</h3><h4 id="RequestParamMethodArgumentResolver"><a href="#RequestParamMethodArgumentResolver" class="headerlink" title="RequestParamMethodArgumentResolver"></a>RequestParamMethodArgumentResolver</h4><p>
&emsp;&emsp;
  参数需使用 @RequestParam 标注，且 name 属性有值，参数通常为普通类型、Map 类型；或 MultipartFile、Part 类型，或 MultipartFile、Part 这两种类型的集合、数组。<br>
&emsp;&emsp;
【扩】RequestParam 注解<br>
&emsp;&emsp;
value：参数名字，即入参的请求参数名字。指定 value 值时，可以获取request中指定参数的值，可以解决前后端参数名称不一致。未指定 value 值，如果参数类型为 Map 或 MultiValueMap 时，用来接收request中所有参数的值。<br>
&emsp;&emsp;
required：默认为 true，如果前台不传递此参数，后台会报错404。如果设置为 false，如果不传，默认为 null。<br>
&emsp;&emsp;
defaultValue：默认参数值，如果设置了该值，required=true将失效，自动为false。<br>
</p>
 
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@RequestMapping(<span class="string">&quot;/test1&quot;</span>)</span><br><span class="line">@ResponseBody</span><br><span class="line">public Map&lt;String, Object&gt; test1(@RequestParam(<span class="string">&quot;rqname&quot;</span>) String name,</span><br><span class="line">                           @RequestParam(<span class="string">&quot;rqage&quot;</span>) int age,</span><br><span class="line">                           @RequestParam(<span class="string">&quot;rqp1&quot;</span>) String[] p1Map,</span><br><span class="line">                           @RequestParam Map&lt;String, String&gt; requestParams1,</span><br><span class="line">                           @RequestParam MultiValueMap requestParams2)&#123;</span><br><span class="line">    Map&lt;String, Object&gt; result = new LinkedHashMap&lt;&gt;();</span><br><span class="line">    result.put(<span class="string">&quot;name&quot;</span>, name);</span><br><span class="line">    result.put(<span class="string">&quot;age&quot;</span>, age);</span><br><span class="line">    result.put(<span class="string">&quot;p1Map&quot;</span>, p1Map);</span><br><span class="line">    result.put(<span class="string">&quot;requestParams1&quot;</span>, requestParams1);</span><br><span class="line">    result.put(<span class="string">&quot;requestParams2&quot;</span>, requestParams2);</span><br><span class="line">    <span class="built_in">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="RequestParamMapMethodArgumentResolver"><a href="#RequestParamMapMethodArgumentResolver" class="headerlink" title="RequestParamMapMethodArgumentResolver"></a>RequestParamMapMethodArgumentResolver</h4><p>
&emsp;&emsp;
  参数需使用 @RequestParam 标注，且 name 属性没有值，参数为 Map 类型；参数的值从 request 的参数中取值，Map 中的 key 对应参数名称，value 对应参数的值
</p>

<h4 id="PathVariableMapMethodArgumentResolver"><a href="#PathVariableMapMethodArgumentResolver" class="headerlink" title="PathVariableMapMethodArgumentResolver"></a>PathVariableMapMethodArgumentResolver</h4><p>
&emsp;&emsp;
  参数需使用@PathVariable 标注，参数通常为基本类型
</p>

<h4 id="RequestHeaderMethodArgumentResolver"><a href="#RequestHeaderMethodArgumentResolver" class="headerlink" title="RequestHeaderMethodArgumentResolver"></a>RequestHeaderMethodArgumentResolver</h4><p>
&emsp;&emsp;
  参数需使用@RequestHeader 标注，参数通常为 Map、MultiValueMap、HttpHeaders 类型<br>
&emsp;&emsp;
【扩】@RequestHeader注解<br>
&emsp;&emsp;
将HTTP请求头中的变量值映射到控制器的参数中（比如Host、From、User-Agent等），参数：value，required，defaultValue，用法同@RequestParam。
</p>

<h4 id="ServletCookieValueMethodArgumentResolver"><a href="#ServletCookieValueMethodArgumentResolver" class="headerlink" title="ServletCookieValueMethodArgumentResolver"></a>ServletCookieValueMethodArgumentResolver</h4><p>
&emsp;&emsp;
  参数需使用@CookieValue 标注，参数为普通类型或者 Cookie 类型
</p>

<h4 id="ModelMethodProcessor"><a href="#ModelMethodProcessor" class="headerlink" title="ModelMethodProcessor"></a>ModelMethodProcessor</h4><p>
&emsp;&emsp;
  参数为 Model 类型，控制器中可以调用 model.addAttribute 想模型中放数据，最终这些数据都会通过 request.setAttribute 复制到 request 中
</p>

<h4 id="MapMethodProcessor"><a href="#MapMethodProcessor" class="headerlink" title="MapMethodProcessor"></a>MapMethodProcessor</h4><p>
&emsp;&emsp;
  处理参数为 Map 类型，但没有标注任何注解的情况，它的执行顺序是很靠后的，所以有点兜底的意思。这个处理器同时也解释了：为何你方法入参上写个Map、Model及ModelMap （都是org.springframework.validation.support.BindingAwareModelMap类型）等等就可以非常便捷的获取到模型的值。
</p>

<h4 id="RequestAttributeMethodArgumentResolver"><a href="#RequestAttributeMethodArgumentResolver" class="headerlink" title="RequestAttributeMethodArgumentResolver"></a>RequestAttributeMethodArgumentResolver</h4><p>
&emsp;&emsp;
  参数需使用@RequestAttribute
</p>

<h4 id="SessionAttributeMethodArgumentResolver"><a href="#SessionAttributeMethodArgumentResolver" class="headerlink" title="SessionAttributeMethodArgumentResolver"></a>SessionAttributeMethodArgumentResolver</h4><p>
&emsp;&emsp;
  参数需使用@SessionAttribute
</p>

<h4 id="ServletModelAttributeMethodProcessor"><a href="#ServletModelAttributeMethodProcessor" class="headerlink" title="ServletModelAttributeMethodProcessor"></a>ServletModelAttributeMethodProcessor</h4><p>
&emsp;&emsp;
  为我们自定义的 javabean 赋值
</p>

<h4 id="RequestResponseBodyMethodProcessor"><a href="#RequestResponseBodyMethodProcessor" class="headerlink" title="RequestResponseBodyMethodProcessor"></a>RequestResponseBodyMethodProcessor</h4><p>
&emsp;&emsp;
  参数需使用@RequestBody 标注
</p>
    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2023/03/16/Spring%E7%B3%BB%E5%88%971/" rel="prev" title="Spring">
      <i class="fa fa-chevron-left"></i> Spring
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFSpring-MVC"><span class="nav-number">1.</span> <span class="nav-text">什么是Spring MVC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="nav-number">1.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%B7%E6%B1%82%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="nav-number">1.2.</span> <span class="nav-text">请求执行流程</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#DispatcherServlet"><span class="nav-number">2.</span> <span class="nav-text">DispatcherServlet</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SpringMVC%E7%9A%84%E4%B9%9D%E5%A4%A7%E7%BB%84%E4%BB%B6"><span class="nav-number">3.</span> <span class="nav-text">SpringMVC的九大组件</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HandlerMapping"><span class="nav-number">4.</span> <span class="nav-text">HandlerMapping</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%8B%E7%BB%8D"><span class="nav-number">4.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#dispatchServlet%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="nav-number">4.2.</span> <span class="nav-text">dispatchServlet的初始化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#BeanNameUrlHandlerMapping"><span class="nav-number">4.2.1.</span> <span class="nav-text">BeanNameUrlHandlerMapping</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SimpleUrlHandlerMapping"><span class="nav-number">4.2.2.</span> <span class="nav-text">SimpleUrlHandlerMapping</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RequestMappingHandlerMapping"><span class="nav-number">4.2.3.</span> <span class="nav-text">RequestMappingHandlerMapping</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HandlerAdapter"><span class="nav-number">5.</span> <span class="nav-text">HandlerAdapter</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B-1"><span class="nav-number">5.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BA%E4%BD%95%E9%9C%80%E8%A6%81%E4%BD%BF%E7%94%A8HandlerAdapter%E9%80%82%E9%85%8D"><span class="nav-number">5.2.</span> <span class="nav-text">为何需要使用HandlerAdapter适配</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8EHandlerMapping%E5%8C%BA%E5%88%AB"><span class="nav-number">5.3.</span> <span class="nav-text">与HandlerMapping区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="nav-number">5.4.</span> <span class="nav-text">实现类</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SpringMVC%E4%B8%AD%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E7%9A%84%E6%8E%A5%E6%94%B6"><span class="nav-number">6.</span> <span class="nav-text">SpringMVC中请求参数的接收</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B-2"><span class="nav-number">6.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HandlerMethodArgumentResolver"><span class="nav-number">6.2.</span> <span class="nav-text">HandlerMethodArgumentResolver</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%8B%E7%BB%8D-1"><span class="nav-number">6.2.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BA%90%E7%A0%81"><span class="nav-number">6.2.2.</span> <span class="nav-text">源码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84-HandlerMethodArgumentResolver%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="nav-number">6.2.3.</span> <span class="nav-text">常见的 HandlerMethodArgumentResolver实现类</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#RequestParamMethodArgumentResolver"><span class="nav-number">6.2.3.1.</span> <span class="nav-text">RequestParamMethodArgumentResolver</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RequestParamMapMethodArgumentResolver"><span class="nav-number">6.2.3.2.</span> <span class="nav-text">RequestParamMapMethodArgumentResolver</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PathVariableMapMethodArgumentResolver"><span class="nav-number">6.2.3.3.</span> <span class="nav-text">PathVariableMapMethodArgumentResolver</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RequestHeaderMethodArgumentResolver"><span class="nav-number">6.2.3.4.</span> <span class="nav-text">RequestHeaderMethodArgumentResolver</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ServletCookieValueMethodArgumentResolver"><span class="nav-number">6.2.3.5.</span> <span class="nav-text">ServletCookieValueMethodArgumentResolver</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ModelMethodProcessor"><span class="nav-number">6.2.3.6.</span> <span class="nav-text">ModelMethodProcessor</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MapMethodProcessor"><span class="nav-number">6.2.3.7.</span> <span class="nav-text">MapMethodProcessor</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RequestAttributeMethodArgumentResolver"><span class="nav-number">6.2.3.8.</span> <span class="nav-text">RequestAttributeMethodArgumentResolver</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SessionAttributeMethodArgumentResolver"><span class="nav-number">6.2.3.9.</span> <span class="nav-text">SessionAttributeMethodArgumentResolver</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ServletModelAttributeMethodProcessor"><span class="nav-number">6.2.3.10.</span> <span class="nav-text">ServletModelAttributeMethodProcessor</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RequestResponseBodyMethodProcessor"><span class="nav-number">6.2.3.11.</span> <span class="nav-text">RequestResponseBodyMethodProcessor</span></a></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Alexior</p>
  <div class="site-description" itemprop="description">蓦然回首，那是我们逝去的青春</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">4</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Alexior</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
